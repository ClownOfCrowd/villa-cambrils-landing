// Enhanced Chatbot Knowledge Base with PDF data integration
export const villaKnowledgeBase = {
  es: {
    property: {
      price: "1.499.990 €",
      size: "805 m²",
      bedrooms: "6 habitaciones",
      bathrooms: "7 baños",
      features: [
        "Piscina privada en jardín",
        "Zona de barbacoa",
        "Sauna de madera",
        "Garaje para 3-4 coches",
        "Gimnasio y sala de cine",
        "Chimenea en sala de estar",
        "Cocina independiente totalmente equipada",
        "Cuarto de plancha y lavadero",
        "Terraza con vistas despejadas"
      ],
      location: "Jardines de Vilafortuny, Cambrils",
      beach_distance: "1.300 metros de las playas",
      portaventura: "15 minutos en coche a PortAventura",
      year_built: "1993 (reformada con materiales de alta calidad)",
      energy_rating: "Mansión de alta standing",
      orientation: "Excelente comunicación con autovía y autopista",
      plot_size: "791 m² de parcela"
    },
    advantages: [
      "Ubicación privilegiada en zona residencial tranquila",
      "Excelente conectividad con autopistas AP-7 y N-340",
      "Cerca de centros comerciales y restaurantes",
      "Zona verde con espacios naturales protegidos",
      "Transporte público directo a Barcelona y Tarragona",
      "Comunidad segura con vigilancia 24h",
      "Proximidad a colegios internacionales",
      "Campo de golf a 10 minutos"
    ],
    technical_specs: {
      construction: "Mansión de alta standing reformada con materiales de alta calidad",
      layout: "Distribuida en tres plantas más planta sótano",
      basement: "Garaje para 3-4 coches, piso auxiliar (sala, cocina, dormitorio, baño), almacén",
      ground_floor: "Amplio recibidor, salón comedor, sala de estar con chimenea, dormitorio suite, aseo, cocina independiente, cuarto de plancha",
      first_floor: "4 habitaciones: tres dormitorios dobles (dos suite), dormitorio principal con vestidor y baño completo",
      second_floor: "Espacio diáfano: gimnasio, sala de cine, despacho, baño, terraza con vistas despejadas"
    },
    legal_info: {
      license: "Licencia de primera ocupación vigente",
      taxes: "IBI: 2.400€/año aproximadamente",
      community: "Gastos de comunidad: 150€/mes",
      documentation: "Toda la documentación legal en regla"
    }
  },
  en: {
    property: {
      price: "€1,499,990",
      size: "805 m²",
      bedrooms: "6 bedrooms",
      bathrooms: "7 bathrooms",
      features: [
        "Private pool in garden",
        "Barbecue area",
        "Wooden sauna",
        "Garage for 3-4 cars",
        "Gym and cinema room",
        "Fireplace in living room",
        "Fully equipped independent kitchen",
        "Laundry and ironing room",
        "Terrace with unobstructed views"
      ],
      location: "Jardines de Vilafortuny, Cambrils",
      beach_distance: "1,300 meters from beaches",
      portaventura: "15 minutes by car to PortAventura",
      year_built: "1993 (renovated with high quality materials)",
      energy_rating: "High standing mansion",
      orientation: "Excellent highway and motorway connections",
      plot_size: "791 m² plot"
    },
    advantages: [
      "Privileged location in quiet residential area",
      "Excellent highway connectivity AP-7 and N-340",
      "Close to shopping centers and restaurants",
      "Green areas with protected natural spaces",
      "Direct public transport to Barcelona and Tarragona",
      "Safe community with 24h security",
      "Proximity to international schools",
      "Golf course 10 minutes away"
    ],
    technical_specs: {
      construction: "High standing mansion renovated with high quality materials",
      layout: "Distributed over three floors plus basement",
      basement: "Garage for 3-4 cars, auxiliary apartment (living room, kitchen, bedroom, bathroom), storage",
      ground_floor: "Large entrance hall, living-dining room, living room with fireplace, bedroom suite, toilet, independent kitchen, laundry room",
      first_floor: "4 bedrooms: three double bedrooms (two suites), master bedroom with dressing room and full bathroom",
      second_floor: "Open space: gym, cinema room, office, bathroom, terrace with unobstructed views"
    },
    legal_info: {
      license: "Valid first occupancy license",
      taxes: "Property tax: approximately €2,400/year",
      community: "Community fees: €150/month",
      documentation: "All legal documentation in order"
    }
  },
  ca: {
    property: {
      price: "1.499.990 €",
      size: "805 m²",
      bedrooms: "6 habitacions",
      bathrooms: "7 banys",
      features: [
        "Piscina privada al jardí",
        "Zona de barbacoa",
        "Sauna de fusta",
        "Garatge per a 3-4 cotxes",
        "Gimnàs i sala de cinema",
        "Xemeneia a la sala d'estar",
        "Cuina independent totalment equipada",
        "Quarto de planxa i rentador",
        "Terrassa amb vistes despejades"
      ],
      location: "Jardins de Vilafortuny, Cambrils",
      beach_distance: "1.300 metres de les platges",
      portaventura: "15 minuts amb cotxe a PortAventura",
      year_built: "1993 (reformada amb materials d'alta qualitat)",
      energy_rating: "Mansió d'alt standing",
      orientation: "Excel·lent comunicació amb autovia i autopista",
      plot_size: "791 m² de parcel·la"
    },
    advantages: [
      "Ubicació privilegiada en zona residencial tranquil·la",
      "Excel·lent connectivitat amb autopistes AP-7 i N-340",
      "A prop de centres comercials i restaurants",
      "Zona verda amb espais naturals protegits",
      "Transport públic directe a Barcelona i Tarragona",
      "Comunitat segura amb vigilància 24h",
      "Proximitat a col·legis internacionals",
      "Camp de golf a 10 minuts"
    ],
    technical_specs: {
      construction: "Mansió d'alt standing reformada amb materials d'alta qualitat",
      layout: "Distribuïda en tres plantes més planta soterrani",
      basement: "Garatge per a 3-4 cotxes, pis auxiliar (sala, cuina, dormitori, bany), magatzem",
      ground_floor: "Ampli rebedor, saló menjador, sala d'estar amb xemeneia, dormitori suite, lavabo, cuina independent, quarto de planxa",
      first_floor: "4 habitacions: tres dormitoris dobles (dos suite), dormitori principal amb vestidor i bany complet",
      second_floor: "Espai diàfan: gimnàs, sala de cinema, despatx, bany, terrassa amb vistes despejades"
    },
    legal_info: {
      license: "Llicència de primera ocupació vigent",
      taxes: "IBI: 2.400€/any aproximadament",
      community: "Despeses de comunitat: 150€/mes",
      documentation: "Tota la documentació legal en regla"
    }
  },
  ru: {
    property: {
      price: "1.499.990 €",
      size: "805 м²",
      bedrooms: "6 спален",
      bathrooms: "7 ванных комнат",
      features: [
        "Частный бассейн в саду",
        "Зона барбекю",
        "Деревянная сауна",
        "Гараж на 3-4 автомобиля",
        "Спортзал и кинозал",
        "Камин в гостиной",
        "Отдельная полностью оборудованная кухня",
        "Гладильная и прачечная",
        "Терраса с открытыми видами"
      ],
      location: "Жардинс де Вилафортуни, Камбрилс",
      beach_distance: "1.300 метров до пляжей",
      portaventura: "15 минут на машине до Порт-Авентуры",
      year_built: "1993 (отремонтированная высококачественными материалами)",
      energy_rating: "Особняк высокого класса",
      orientation: "Отличное сообщение с автомагистралями",
      plot_size: "Участок 791 м²"
    },
    advantages: [
      "Привилегированное расположение в тихом жилом районе",
      "Отличная связь с автомагистралями AP-7 и N-340",
      "Рядом торговые центры и рестораны",
      "Зеленая зона с охраняемыми природными пространствами",
      "Прямое сообщение с Барселоной и Таррагоной",
      "Безопасное сообщество с охраной 24ч",
      "Близость к международным школам",
      "Поле для гольфа в 10 минутах"
    ],
    technical_specs: {
      construction: "Особняк высокого класса, отремонтированный высококачественными материалами",
      layout: "Распределен на трех этажах плюс цокольный этаж",
      basement: "Гараж на 3-4 автомобиля, вспомогательная квартира (гостиная, кухня, спальня, ванная), кладовая",
      ground_floor: "Просторная прихожая, гостиная-столовая, гостиная с камином, спальня-люкс, туалет, отдельная кухня, гладильная",
      first_floor: "4 спальни: три двойные спальни (две люкс), главная спальня с гардеробной и полной ванной",
      second_floor: "Открытое пространство: спортзал, кинозал, кабинет, ванная, терраса с открытыми видами"
    },
    legal_info: {
      license: "Действующая лицензия первого заселения",
      taxes: "Налог на недвижимость: примерно 2.400€/год",
      community: "Коммунальные расходы: 150€/месяц",
      documentation: "Вся юридическая документация в порядке"
    }
  }
};

// Enhanced response patterns for better AI understanding
export const responsePatterns = {
  price: ['precio', 'price', 'preu', 'цена', 'стоимость', 'cost', 'coste', 'vale', 'cuesta'],
  size: ['tamaño', 'metros', 'size', 'mida', 'размер', 'площадь', 'surface', 'superficie', 'm2'],
  bedrooms: ['dormitorios', 'habitaciones', 'bedrooms', 'habitacions', 'спальни', 'комнат', 'cuartos'],
  bathrooms: ['baños', 'bathrooms', 'banys', 'ванн', 'туалет', 'wc', 'aseos'],
  location: ['ubicación', 'donde', 'location', 'where', 'ubicació', 'on', 'где', 'расположение', 'sitio'],
  beach: ['playa', 'beach', 'platja', 'пляж', 'море', 'mar', 'costa'],
  pool: ['piscina', 'pool', 'бассейн', 'swimming'],
  parking: ['parking', 'garaje', 'garage', 'pàrquing', 'парковка', 'aparcamiento'],
  portaventura: ['portaventura', 'port aventura', 'парк развлечений', 'parque', 'atracciones'],
  garden: ['jardín', 'garden', 'jardí', 'сад', 'verde', 'plantas'],
  year: ['año', 'cuando', 'construido', 'year', 'built', 'any', 'construït', 'год', 'построен'],
  energy: ['energética', 'energy', 'energètica', 'энергетический', 'eficiencia', 'класс'],
  legal: ['legal', 'documentos', 'papers', 'documents', 'документы', 'лицензия', 'papers'],
  taxes: ['impuestos', 'taxes', 'impostos', 'налоги', 'ibi', 'gastos'],
  technical: ['técnico', 'technical', 'tècnic', 'технический', 'construcción', 'materials'],
  investment: ['inversión', 'investment', 'inversió', 'инвестиция', 'rentabilidad', 'negocio'],
  features: ['características', 'features', 'prestaciones', 'функции', 'что есть', 'что включено', 'amenities', 'facilities'],
  layout: ['distribución', 'layout', 'distribució', 'планировка', 'plantas', 'floors', 'plantes', 'этажи', 'como distribuida'],
  sauna: ['sauna', 'сауна'],
  cinema: ['cine', 'cinema', 'кино', 'sala de cine', 'кинозал'],
  gym: ['gimnasio', 'gym', 'gimnàs', 'спортзал', 'fitness']
};

// Context-aware response generator
export const generateEnhancedResponse = (userMessage, language) => {
  const knowledge = villaKnowledgeBase[language];
  const lowerMessage = userMessage.toLowerCase();
  
  // Multi-pattern matching for better accuracy
  const matchedPatterns = Object.entries(responsePatterns).filter(([key, patterns]) =>
    patterns.some(pattern => lowerMessage.includes(pattern))
  );

  if (matchedPatterns.length === 0) {
    return getFallbackResponse(language);
  }

  // Generate contextual responses based on matched patterns
  const responses = {
    es: generateSpanishResponse(matchedPatterns, knowledge, lowerMessage),
    en: generateEnglishResponse(matchedPatterns, knowledge, lowerMessage),
    ca: generateCatalanResponse(matchedPatterns, knowledge, lowerMessage),
    ru: generateRussianResponse(matchedPatterns, knowledge, lowerMessage)
  };

  return responses[language] || getFallbackResponse(language);
};

// Language-specific response generators
function generateSpanishResponse(patterns, knowledge, message) {
  const patternTypes = patterns.map(([type]) => type);
  
  if (patternTypes.includes('price')) {
    return `💰 El precio de esta exclusiva villa es de **${knowledge.property.price}**. Incluye ${knowledge.property.size} de superficie construida en una parcela de ${knowledge.property.plot_size}. La propiedad está construida en ${knowledge.property.year_built} con certificación energética ${knowledge.property.energy_rating}.`;
  }
  
  if (patternTypes.includes('size')) {
    return `📐 La villa tiene **${knowledge.property.size}** de superficie construida en una parcela de **${knowledge.property.plot_size}**. Está perfectamente distribuida con ${knowledge.property.bedrooms} y ${knowledge.property.bathrooms}, además de amplias zonas comunes y terraza panorámica de 150m².`;
  }
  
  if (patternTypes.includes('bedrooms')) {
    return `🛏️ La propiedad cuenta con **${knowledge.property.bedrooms}** amplios y luminosos, cada uno con acceso a terraza o balcón. Todas las habitaciones tienen suelo de parquet y ventanas de PVC con doble acristalamiento para máximo confort.`;
  }
  
  if (patternTypes.includes('bathrooms')) {
    return `🚿 La villa dispone de **${knowledge.property.bathrooms}** completamente equipados con acabados de alta calidad y sanitarios de última generación.`;
  }
  
  if (patternTypes.includes('location') || patternTypes.includes('beach')) {
    return `🏖️ Ubicada en **${knowledge.property.location}**, una zona premium de la Costa Dorada. **${knowledge.property.beach_distance}** y ${knowledge.property.portaventura}. La zona cuenta con excelente conectividad a Barcelona y Tarragona.`;
  }
  
  if (patternTypes.includes('pool') || patternTypes.includes('garden')) {
    return `🏊‍♂️ Sí, incluye una **piscina privada** con zona de relax en un precioso **jardín mediterráneo de 400m²**. El jardín está diseñado con plantas autóctonas que requieren poco mantenimiento y proporcionan privacidad total.`;
  }
  
  if (patternTypes.includes('portaventura')) {
    return `🎢 ¡Perfecto para familias! **${knowledge.property.portaventura}**, uno de los parques temáticos más famosos de Europa. ¡Los niños lo van a adorar!`;
  }
  
  if (patternTypes.includes('parking')) {
    return `🚗 Sí, cuenta con **garaje para 3 vehículos** con puertas automáticas. También hay plazas de aparcamiento adicionales en la parcela.`;
  }
  
  if (patternTypes.includes('year')) {
    return `🏗️ La villa fue construida en **${knowledge.property.year_built}** con tecnologías y materiales de última generación. ¡Construcción nueva con garantía de calidad!`;
  }
  
  if (patternTypes.includes('energy')) {
    return `⚡ ¡Excelente noticia! La villa tiene **${knowledge.property.energy_rating}**, lo que significa gastos mínimos en servicios y máximo confort durante todo el año.`;
  }
  
  if (patternTypes.includes('technical')) {
    return `🔧 **Especificaciones técnicas:** ${knowledge.technical_specs.construction}, ${knowledge.technical_specs.roof}, ${knowledge.technical_specs.windows}. Cuenta con ${knowledge.technical_specs.insulation} y ${knowledge.technical_specs.utilities}.`;
  }
  
  if (patternTypes.includes('legal') || patternTypes.includes('taxes')) {
    return `📋 **Información legal:** ${knowledge.legal_info.license}. ${knowledge.legal_info.taxes}, ${knowledge.legal_info.community}. ${knowledge.legal_info.documentation}.`;
  }
  
  if (patternTypes.includes('investment')) {
    return `📈 ¡Excelente inversión! Cambrils es una ciudad turística en crecimiento con alto potencial de revalorización. La rentabilidad por alquiler puede ser del 4-6% anual.`;
  }
  
  return getFallbackResponse('es');
}

function generateEnglishResponse(patterns, knowledge, message) {
  const patternTypes = patterns.map(([type]) => type);
  
  if (patternTypes.includes('price')) {
    return `💰 The price of this exclusive villa is **${knowledge.property.price}**. It includes ${knowledge.property.size} of built surface on a ${knowledge.property.plot_size}. The property was built in ${knowledge.property.year_built} with ${knowledge.property.energy_rating}.`;
  }
  
  if (patternTypes.includes('size')) {
    return `📐 The villa has **${knowledge.property.size}** of built surface on a **${knowledge.property.plot_size}**. It's perfectly distributed with ${knowledge.property.bedrooms} and ${knowledge.property.bathrooms}, plus spacious common areas and a 150m² panoramic terrace.`;
  }
  
  if (patternTypes.includes('bedrooms')) {
    return `🛏️ The property features **${knowledge.property.bedrooms}** spacious and bright rooms, each with access to terrace or balcony. All bedrooms have parquet flooring and PVC windows with double glazing for maximum comfort.`;
  }
  
  if (patternTypes.includes('bathrooms')) {
    return `🚿 The villa has **${knowledge.property.bathrooms}** fully equipped with high-quality finishes and state-of-the-art fixtures.`;
  }
  
  if (patternTypes.includes('location') || patternTypes.includes('beach')) {
    return `🏖️ Located in **${knowledge.property.location}**, a premium area of Costa Dorada. **${knowledge.property.beach_distance}** and ${knowledge.property.portaventura}. The area has excellent connectivity to Barcelona and Tarragona.`;
  }
  
  if (patternTypes.includes('pool') || patternTypes.includes('garden')) {
    return `🏊‍♂️ Yes, it includes a **private pool** with relaxation area in a beautiful **400m² Mediterranean garden**. The garden is designed with native plants requiring little maintenance and providing total privacy.`;
  }
  
  if (patternTypes.includes('portaventura')) {
    return `🎢 Perfect for families! **${knowledge.property.portaventura}**, one of Europe's most famous theme parks. The kids will absolutely love it!`;
  }
  
  if (patternTypes.includes('parking')) {
    return `🚗 Yes, it has a **3-car garage** with automatic doors. There are also additional parking spaces on the plot.`;
  }
  
  if (patternTypes.includes('year')) {
    return `🏗️ The villa was built in **${knowledge.property.year_built}** using cutting-edge technologies and materials. New construction with quality guarantee!`;
  }
  
  if (patternTypes.includes('energy')) {
    return `⚡ Excellent news! The villa has **${knowledge.property.energy_rating}**, meaning minimal utility costs and maximum comfort year-round.`;
  }
  
  if (patternTypes.includes('technical')) {
    return `🔧 **Technical specifications:** ${knowledge.technical_specs.construction}, ${knowledge.technical_specs.roof}, ${knowledge.technical_specs.windows}. Features ${knowledge.technical_specs.insulation} and ${knowledge.technical_specs.utilities}.`;
  }
  
  if (patternTypes.includes('legal') || patternTypes.includes('taxes')) {
    return `📋 **Legal information:** ${knowledge.legal_info.license}. ${knowledge.legal_info.taxes}, ${knowledge.legal_info.community}. ${knowledge.legal_info.documentation}.`;
  }
  
  if (patternTypes.includes('investment')) {
    return `📈 Excellent investment! Cambrils is a growing tourist city with high potential for property value appreciation. Rental yield can be 4-6% annually.`;
  }
  
  return getFallbackResponse('en');
}

function generateCatalanResponse(patterns, knowledge, message) {
  const patternTypes = patterns.map(([type]) => type);
  
  if (patternTypes.includes('price')) {
    return `💰 El preu d'aquesta vil·la exclusiva és de **${knowledge.property.price}**. Inclou ${knowledge.property.size} de superfície construïda en una parcel·la de ${knowledge.property.plot_size}. La propietat està construïda el ${knowledge.property.year_built} amb ${knowledge.property.energy_rating}.`;
  }
  
  if (patternTypes.includes('location') || patternTypes.includes('beach')) {
    return `🏖️ Ubicada a **${knowledge.property.location}**, una zona premium de la Costa Daurada. **${knowledge.property.beach_distance}** i ${knowledge.property.portaventura}. La zona compta amb excel·lent connectivitat a Barcelona i Tarragona.`;
  }
  
  return getFallbackResponse('ca');
}

function generateRussianResponse(patterns, knowledge, message) {
  const patternTypes = patterns.map(([type]) => type);
  
  if (patternTypes.includes('price')) {
    return `💰 Цена этой эксклюзивной виллы составляет **${knowledge.property.price}**. Включает ${knowledge.property.size} застроенной площади на участке ${knowledge.property.plot_size}. Недвижимость построена в ${knowledge.property.year_built} году с ${knowledge.property.energy_rating}.`;
  }
  
  if (patternTypes.includes('size')) {
    return `📐 Вилла имеет **${knowledge.property.size}** застроенной площади на участке **${knowledge.property.plot_size}**. Идеально распределена с ${knowledge.property.bedrooms} и ${knowledge.property.bathrooms}, плюс просторные общие зоны и панорамная терраса 150м².`;
  }
  
  if (patternTypes.includes('bedrooms')) {
    return `🛏️ В вилле **${knowledge.property.bedrooms}** просторных и светлых, каждая с выходом на террасу или балкон. Во всех спальнях паркетные полы и ПВХ окна с двойным остеклением для максимального комфорта.`;
  }
  
  if (patternTypes.includes('bathrooms')) {
    return `🚿 В собственности **${knowledge.property.bathrooms}** полностью оборудованных высококачественной отделкой и современной сантехникой.`;
  }
  
  if (patternTypes.includes('location') || patternTypes.includes('beach')) {
    return `🏖️ Расположена в **${knowledge.property.location}**, премиальном районе Коста-Дорада. **${knowledge.property.beach_distance}** и ${knowledge.property.portaventura}. В районе отличное сообщение с Барселоной и Таррагоной.`;
  }
  
  if (patternTypes.includes('pool') || patternTypes.includes('garden')) {
    return `🏊‍♂️ Да, включает **частный бассейн** с зоной отдыха в красивом **средиземноморском саду 400м²**. Сад спроектирован с местными растениями, требующими минимального ухода и обеспечивающими полную приватность.`;
  }
  
  if (patternTypes.includes('portaventura')) {
    return `🎢 Идеально для семей! **${knowledge.property.portaventura}**, один из самых известных тематических парков Европы. Дети будут в восторге!`;
  }
  
  if (patternTypes.includes('parking')) {
    return `🚗 Да, есть **гараж на 3 автомобиля** с автоматическими воротами. Также дополнительные парковочные места на участке.`;
  }
  
  if (patternTypes.includes('year')) {
    return `🏗️ Вилла построена в **${knowledge.property.year_built} году** с использованием современных технологий и материалов. Новое строительство с гарантией качества!`;
  }
  
  if (patternTypes.includes('energy')) {
    return `⚡ Отличная новость! Вилла имеет **${knowledge.property.energy_rating}**, что означает минимальные расходы на коммунальные услуги и максимальный комфорт круглый год.`;
  }
  
  if (patternTypes.includes('technical')) {
    return `🔧 **Технические характеристики:** ${knowledge.technical_specs.construction}, ${knowledge.technical_specs.roof}, ${knowledge.technical_specs.windows}. ${knowledge.technical_specs.insulation} и ${knowledge.technical_specs.utilities}.`;
  }
  
  if (patternTypes.includes('legal') || patternTypes.includes('taxes')) {
    return `📋 **Юридическая информация:** ${knowledge.legal_info.license}. ${knowledge.legal_info.taxes}, ${knowledge.legal_info.community}. ${knowledge.legal_info.documentation}.`;
  }
  
  if (patternTypes.includes('investment')) {
    return `📈 Отличная инвестиция! Камбрилс - растущий курортный город с высоким потенциалом роста стоимости недвижимости. Доходность от аренды может составлять 4-6% в год.`;
  }
  
  if (patternTypes.includes('features')) {
    const features = knowledge.property.features.slice(0, 6).join(', ');
    return `✨ **Основные характеристики:** ${features}. Эта вилла сочетает роскошь, комфорт и технологии в привилегированном месте Коста-Дорада.`;
  }
  
  if (patternTypes.includes('layout')) {
    return `🏗️ **Планировка особняка:** ${knowledge.technical_specs.layout}.\n\n**Цокольный этаж:** ${knowledge.technical_specs.basement}\n**Первый этаж:** ${knowledge.technical_specs.ground_floor}\n**Второй этаж:** ${knowledge.technical_specs.first_floor}\n**Третий этаж:** ${knowledge.technical_specs.second_floor}`;
  }
  
  if (patternTypes.includes('sauna')) {
    return `🧖‍♀️ Да! В особняке есть **деревянная сауна** - идеальное место для релаксации после долгого дня. Расположена в садовой зоне рядом с бассейном.`;
  }
  
  if (patternTypes.includes('cinema')) {
    return `🎬 Великолепно! На третьем этаже расположен **кинозал** в открытом пространстве. Идеально для семейных вечеров и просмотра фильмов в домашней атмосфере.`;
  }
  
  if (patternTypes.includes('gym')) {
    return `🏋️‍♂️ Отлично! На третьем этаже находится **спортзал** в открытом пространстве. Поддерживайте форму не выходя из дома!`;
  }
  
  return getFallbackResponse('ru');
}

function getFallbackResponse(language) {
  const fallbacks = {
    es: `Gracias por tu consulta sobre esta magnífica villa. Para información más detallada y personalizada, no dudes en contactarnos:\n\n📱 **WhatsApp:** +34 677 743 005\n📧 **Email:** info@inmolarisa.com\n\n¡Estaremos encantados de resolver todas tus dudas y organizar una visita!`,
    en: `Thank you for your inquiry about this magnificent villa. For more detailed and personalized information, please don't hesitate to contact us:\n\n📱 **WhatsApp:** +34 677 743 005\n📧 **Email:** info@inmolarisa.com\n\nWe'll be happy to answer all your questions and arrange a viewing!`,
    ca: `Gràcies per la teva consulta sobre aquesta magnífica vil·la. Per a informació més detallada i personalitzada, no dubtis a contactar-nos:\n\n📱 **WhatsApp:** +34 677 743 005\n📧 **Email:** info@inmolarisa.com\n\nEstarem encantats de resoldre tots els teus dubtes i organitzar una visita!`,
    ru: `Спасибо за ваш запрос об этой великолепной вилле. Для получения более подробной и персонализированной информации, пожалуйста, свяжитесь с нами:\n\n📱 **WhatsApp:** +34 677 743 005\n📧 **Email:** info@inmolarisa.com\n\nМы будем рады ответить на все ваши вопросы и организовать просмотр!`
  };
  
  return fallbacks[language] || fallbacks.es;
}
